using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;
using System.Data;
using BizCommon;
using System.Drawing;

namespace UnitTests
{
    public class JsonTest
    {
        [Test]
        public void RunSubStringTest()
        {
            HNT h = new HNT()
            {
                ID = Guid.NewGuid(),
                BD = "标段",
                DW = "单位",
                SYS = "试验室",
                GCMC = "工程名称",
                Line = "线路",
                LQ = "龄期",
                QDDJ = "强度等级",
                QDZ = new List<float>() { 12.1f, 12.4f, 12.6f },
                SGBW = "施工部位",
                SYRQ = DateTime.Now,
                ZJRQ = DateTime.Now
            };
            JZCellStyle cs = new JZCellStyle();
            cs.BackColor = Color.White;
            cs.FamilyName = "宋体";
            cs.FontSize = 17;
            cs.FontStyle = FontStyle.Bold;
            cs.ForColor = Color.Black;
            
            GJ j = new GJ()
            {
                ID = Guid.NewGuid(),
                BD = "标段",
                DW = "单位",
                SYS = "试验室",
                GCMC = "工程名称",
                GGXH = "规格型号",
                KLQD = new List<float>() { 123.1f, 123.2f, 123.3f },
                Line = "线路",
                PH = "批号",
                QFQD = new List<float>() { 33.3f, 22.2f, 11.1f },
                SCCJ = "生产厂家",
                SGBW = "施工部位",
                SYRQ = DateTime.Now,
                SYLB = "试验类别",
                ZJ = "直径"
            };
            String json = Newtonsoft.Json.JsonConvert.SerializeObject(h);
            String jsonCS = Newtonsoft.Json.JsonConvert.SerializeObject(cs);

            //string str = "{"ForColor":"Black","BackgroundColor":"White","FamilyName":"宋体","FontStyle":1,"FontSize":17.0}";
            JZCellStyle css = Newtonsoft.Json.JsonConvert.DeserializeObject<JZCellStyle>(jsonCS);

            json = Newtonsoft.Json.JsonConvert.SerializeObject(j);
            Assert.IsNotEmpty(json);
        }

        [Test]
        public void DataSetToJsonTest()
        {
            DataSet ds = new DataSet();
            DataTable dt1 = new DataTable();
            dt1.Columns.Add("UID", typeof(System.Int32));//用户编号
            dt1.Columns.Add("UserName", typeof(System.String));//用户姓名
            for (int i = 0; i < 10; i++)
            {
                var r = dt1.NewRow();
                r["UID"] = i;
                r["UserName"] = "teddy" + i;
                dt1.Rows.Add(r);
            }
            ds.Tables.Add(dt1);

            DataTable dt2 = new DataTable();
            dt2.Columns.Add("K1", typeof(System.Int32));//用户编号
            dt2.Columns.Add("K2", typeof(System.String));//用户姓名
            for (int i = 0; i < 10; i++)
            {
                var r = dt2.NewRow();
                r["K1"] = i;
                r["K2"] = "K" + i;
                dt2.Rows.Add(r);
            }
            dt2.TableName = "[kkk]";
            ds.Tables.Add(dt2);

            Assert.AreEqual(10, dt1.Rows.Count);
            String json = Newtonsoft.Json.JsonConvert.SerializeObject(ds);
            var ds1 = Newtonsoft.Json.JsonConvert.DeserializeObject<DataSet>(json);
            Assert.AreEqual(2, ds1.Tables.Count);
        }

        [Test]
        public void 水泥高性能StadiumConfig()
        {
            StadiumConfig config = new StadiumConfig()
            {
                fZJRQ = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验委托单]", ColumnName = "col_norm_H25" },
                fBGBH = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验报告（高性能）]", ColumnName = "col_norm_L5" },
                fPH = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验委托单]", ColumnName = "col_norm_H9" },
                fWTBH = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验委托单]", ColumnName = "col_norm_H5" },
                fSJBH = null,
                fSJSize = null,
                fAdded = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验委托单]", ColumnName = "col_norm_C11" }
            };
            config.DayList.Add(new StadiumDay() { Days=3, IsParameterDays=false, PDays=null, ItemName="水泥抗压3天", ItemID="63",
            ValidInfo = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验报告（高性能）]", ColumnName = "col_norm_P30" }
            });
            config.DayList.Add(new StadiumDay() { Days = 28, IsParameterDays = false, PDays = null, ItemName = "水泥抗压28天", ItemID = "64",
            ValidInfo = new StadiumColumnInfo() { TableName = "[biz_norm_水泥试验报告（高性能）]", ColumnName = "col_norm_P31" }
            });
            String json = Newtonsoft.Json.JsonConvert.SerializeObject(config);

            Assert.AreEqual("", json);
        }

        [Test]
        public void 混凝土1天StadiumConfig()
        {
            StadiumConfig config = new StadiumConfig()
            {
                fZJRQ = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C21" },
                fBGBH = new StadiumColumnInfo() { TableName = "[biz_norm_1d混凝土检查试件抗压强度试验报告]", ColumnName = "col_norm_R5" },
                fPH = null,
                fWTBH = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_H5" },
                fSJBH = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C8" },
                fSJSize = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C11" },
                fAdded = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C9" }
            };
            config.DayList.Add(new StadiumDay()
            {
                Days = 1,
                IsParameterDays = false,
                PDays = null,
                ItemName = "混凝土抗压1天",
                ItemID = "1",
                ValidInfo = null
            });
            String json = Newtonsoft.Json.JsonConvert.SerializeObject(config);

            Assert.AreEqual("", json);
        }

        [Test]
        public void 混凝土检查试件抗压强度试验报告StadiumConfig()
        {
            StadiumConfig config = new StadiumConfig()
            {
                fZJRQ = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C21" },
                fBGBH = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土检查试件抗压强度试验报告]", ColumnName = "col_norm_R5" },
                fPH = null,
                fWTBH = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_H5" },
                fSJBH = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C8" },
                fSJSize = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C11" },
                fAdded = new StadiumColumnInfo() { TableName = "[biz_norm_混凝土试验任务委托单]", ColumnName = "col_norm_C9" }
            };
            config.DayList.Add(new StadiumDay()
            {
                Days = 3,
                IsParameterDays = false,
                PDays = null,
                ItemName = "混凝土抗压3天",
                ItemID = "92",
                ValidInfo = null
            });
            config.DayList.Add(new StadiumDay()
            {
                Days = 7,
                IsParameterDays = false,
                PDays = null,
                ItemName = "混凝土抗压7天",
                ItemID = "93",
                ValidInfo = null
            });
            config.DayList.Add(new StadiumDay()
            {
                Days = 28,
                IsParameterDays = false,
                PDays = null,
                ItemName = "混凝土抗压28天",
                ItemID = "94",
                ValidInfo = null
            });
            config.DayList.Add(new StadiumDay()
            {
                Days = 56,
                IsParameterDays = false,
                PDays = null,
                ItemName = "混凝土抗压56天",
                ItemID = "95",
                ValidInfo = null
            });
            String json = Newtonsoft.Json.JsonConvert.SerializeObject(config);

            Assert.AreEqual("", json);
        }

        [Test]
        public void JosnTest2()
        {
            String str = @"[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.529464,1.645007,1.761742,1.893962,2.029755,2.179843,2.331122,2.485974,2.6444,2.78734,2.932663,3.076795,3.217353,3.362676,3.485367,3.61044,3.739086,3.857012,3.965408,4.072614,4.176246,4.266775,4.358495,4.43473,4.494288,4.550273,4.609832,4.650332,4.687258,4.726567,4.75992,4.784934,4.806375,4.829008,4.849257,4.850449,4.856404,4.863551,4.865934,4.870698,4.870698,4.869507,4.868316,4.867125,4.867125,4.867125,4.865934,4.864743,4.863551,4.86236,4.861169,4.861169,4.858787,4.857595,4.854022,4.85164,4.849257,4.845684,4.845684,4.845684,4.845684,4.845684,4.845684,4.846875,4.846875,4.846875,4.846875,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.848066,4.849257,4.850449,4.852831,4.852831,4.852831,4.852831,4.85164,4.85164,4.85164,4.85164,4.85164,4.85164,4.85164,4.85164,4.85164,4.852831,4.854022,4.855213,4.855213,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.856404,4.857595,4.859978,4.861169,4.861169,4.861169,4.863551,4.865934,4.865934,4.865934,4.865934,4.865934,4.865934,4.865934,4.865934,4.867125,4.868316,4.869507,4.870698,4.870698,4.870698,4.870698,4.870698,4.870698,4.870698,4.870698,4.87189,4.874272,4.874272,4.874272,4.874272,4.874272,4.876654,4.876654,4.877845,4.880228,4.88261,4.884993,4.887375,4.887375,4.890948,4.892139,4.892139,4.892139,4.892139,4.892139,4.892139,4.892139,4.894522,4.896904,4.898095,4.901669,4.905242,4.906434,4.910007,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.911198,4.912389,4.912389,4.91358,4.915963,4.915963,4.917154,4.921919,4.925492,4.927875,4.93383,4.939786,4.940978,4.942169,4.94336,4.944551,4.946933,4.950507,4.956463,4.961227,4.961227,4.961227,4.961227,4.961227,4.961227,4.961227,4.961227,4.96361,4.965992,4.967183,4.967183,4.967183,4.967183,4.968374,4.968374,4.970757,4.973139,4.979095,4.98386,4.993389,5.002918,5.010066,5.016021,5.024359,5.032698,5.039845,5.05533,5.067242,5.072006,5.074389,5.079154,5.085109,5.0863,5.0863,5.0863,5.0863,5.0863,5.0863,5.0863,5.085109,5.081536,5.07558,5.068433,5.060094,5.051756,5.043418,5.032698,5.025551,5.016021,5.008874,5.006492,5.006492,4.999345,4.99458,4.992198,4.988624,4.986242,4.985051,4.980286,4.980286,4.980286,4.980286,4.980286,4.980286,4.980286,4.980286,4.980286,4.981477,4.982668,4.985051,4.986242,4.986242,4.986242,4.986242,4.986242,4.986242,4.986242,4.986242,4.985051,4.98386,4.982668,4.981477,4.981477,4.981477,4.981477,4.982668,4.985051,4.991007,5.002918,5.04461,5.108932,5.226859,5.40077,5.598504,5.87962,6.210766,6.518088,6.89688,7.257805,7.619921,7.924861,8.098772,8.238139,8.515682,8.881371,9.188693,9.272076,9.225619,9.126753,8.988577,8.988577,9.04337,9.143429,9.424545,9.749735,10.31673,11.04454,11.67705,12.41677,13.17435,13.80329,14.51204,15.21959,15.84258,16.47628,17.13261,17.80205,18.47864,19.24218,19.95688,20.67754,21.40773,22.14268,22.89431,23.65308,24.40709,25.17064,25.94013,26.7132,27.49223,28.27959,29.15868,29.97344,30.79177,31.60892,32.44154,33.28847,34.13182,34.98112,35.83876,36.69283,37.55882,38.43433,39.3146,40.27826,41.149,41.99831,42.80711,43.56946,44.1722,44.5891,44.9143,45.24902,45.57063,45.79695,45.92917,46.02923,46.16145,46.28772,46.41517,46.5331,46.60695,46.62243,46.61767,46.60099,46.53667,46.4509,46.29963,46.10546,45.94228,45.75169,45.57301,45.44079,45.30262,45.16563,45.04771,44.93335,44.80947,44.69035,44.576,44.4688,44.36278,44.25677,44.15433,44.05308,43.94945,43.8482,43.74814,43.64808,43.54921,43.46702,43.39436,43.3348,43.29668,43.25142,43.20735,43.16089,43.11086,43.06441,43.01676,42.97507,42.9441,42.91908,42.89288,42.87382,42.85119,42.82617,42.79996,42.77495,42.74755,42.71658,42.69395,42.66656,42.64154,42.61772,42.59985,42.57245,42.54982,42.52719,42.50098,42.47835,42.45333,42.42356,42.39854,42.37591,42.35566,42.34256,42.31754,42.29015,42.26632,42.23893,42.21391,42.19247,42.17341,42.1484,42.11504,42.10075,42.08407,42.06144,42.03643,42.01498,42.0126,42.01379,42.01975,42.03166,42.06501,42.11981,42.1746,42.26632,42.39259,42.51289,42.66894,42.8357,42.98222,43.14302,43.28477,43.42295,43.5504,43.67191,43.78983,43.91967,44.04474,44.16982,44.29012,44.4152,44.53669,44.65462,44.76421,44.87498,44.98577,45.10369,45.21566,45.32287,45.44079,45.55515,45.66711,45.77551,45.8851,45.98516,46.08641,46.19481,46.29963,46.40088,46.50451,46.61171,46.70939,46.81302,46.90474,47.00956,47.09771,47.17395,47.2609,47.33356,47.40861,47.48008,47.54916,47.61587,47.68615,47.75047,47.80527,47.80169,47.79812,47.80169,47.8148,47.8553,47.90413,47.98632,48.08638,48.16858,48.25791,48.3401,48.40681,48.47351,48.53784,48.60574,48.66887,48.73081,48.79394,48.85826,48.91663,48.97261,49.01073,49.01907,49.03932,49.10841,49.17273,49.23944,49.31329,49.37285,49.4336,49.50031,49.56701,49.63252,49.68851,49.73973,49.79691,49.85408,49.9184,49.97439,50.03871,50.08636,50.12924,50.1483,50.16259,50.18999,50.23407,50.2972,50.36628,50.42704,50.48898,50.55568,50.61643,50.67837,50.74031,50.80225,50.85586,50.90231,50.96068,51.01666,51.06789,51.12149,51.17271,51.22869,51.268,51.27515,51.27515,51.27753,51.28587,51.30135,51.34424,51.41809,51.48718,51.57175,51.65871,51.73018,51.80999,51.88503,51.93625,51.98628,52.05179,52.10063,52.14828,52.20784,52.26263,52.31623,52.37103,52.41748,52.41986,52.41748,52.41748,52.42344,52.43535,52.47346,52.51159,52.56519,52.61522,52.62832,52.61998,52.59854,52.53541,52.46394,52.32814,52.12088,51.91004,51.64203,51.35377,51.11553,50.86539,50.61405,50.41393,50.21024,50.01846,49.82549,49.61585,49.42764,49.23706,49.04885,48.86184,48.68078,47.90175,38.48316,17.83421,5.213756,1.760551,0.0,0.0]";
            List<float> list = Newtonsoft.Json.JsonConvert.DeserializeObject<List<float>>(str);
            var l = (from n in list
                     where n >= 20.1
                     select n).ToList();
            int count = l.Distinct().Count();
            Assert.AreEqual(count, 2);
        }

        [Test]
        public void TestJson()
        {
            var list = Newtonsoft.Json.JsonConvert.DeserializeObject<List<JZCustomView>>("null");
            Assert.IsNotNull(list);
        }
    }

    [Serializable]
    public class ModifyItem
    {
        public String SheetName { get; set; }
        public String CellPosition { get; set; }
        public String OriginalValue { get; set; }
        public String CurrentValue { get; set; }
    }

    [Serializable]
    public class TransferBase
    {
        /// <summary>
        /// 标识
        /// </summary>
        public Guid ID { get; set; }

        /// <summary>
        /// 工程名称
        /// </summary>
        public String GCMC { get; set; }

        /// <summary>
        /// 施工部位
        /// </summary>
        public String SGBW { get; set; }

        /// <summary>
        /// 铁路线
        /// </summary>
        public String Line { get; set; }

        /// <summary>
        /// 标段
        /// </summary>
        public String BD { get; set; }

        /// <summary>
        /// 单位
        /// </summary>
        public String DW { get; set; }

        /// <summary>
        /// 试验室
        /// </summary>
        public String SYS { get; set; }

        /// <summary>
        /// 试验日期
        /// </summary>
        public DateTime SYRQ { get; set; }
    }

    [Serializable]
    public class GJ : TransferBase
    {
        /// <summary>
        /// 试验类别
        /// </summary>
        public String SYLB { get; set; }

        /// <summary>
        /// 规格型号
        /// </summary>
        public String GGXH { get; set; }

        /// <summary>
        /// 直径
        /// </summary>
        public String ZJ { get; set; }

        /// <summary>
        /// 批号
        /// </summary>
        public String PH { get; set; }

        /// <summary>
        /// 生产厂家
        /// </summary>
        public String SCCJ { get; set; }

        /// <summary>
        /// 屈服强度
        /// </summary>
        public List<float> QFQD { get; set; }

        /// <summary>
        /// 抗拉强度
        /// </summary>
        public List<float> KLQD { get; set; }
    }

    [Serializable]
    public class HNT : TransferBase
    {
        /// <summary>
        /// 强度等级
        /// </summary>
        public String QDDJ { get; set; }

        /// <summary>
        /// 制件日期
        /// </summary>
        public DateTime ZJRQ { get; set; }

        /// <summary>
        /// 龄期
        /// </summary>
        public String LQ { get; set; }

        /// <summary>
        /// 强度值
        /// </summary>
        public List<float> QDZ { get; set; }
    }
}
